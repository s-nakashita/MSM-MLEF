!-------------------------------------------------------------------------------
! Description:
!
!   Miscellaneous constant values.
!
! Copyright:
!
!   This software was developed within the context of the EUMETSAT Satellite
!   Application Facility on Numerical Weather Prediction (NWP SAF), under the
!   Cooperation Agreement dated 7 December 2016, between EUMETSAT and the
!   Met Office, UK, by one or more partners within the NWP SAF. The partners
!   in the NWP SAF are the Met Office, ECMWF, DWD and MeteoFrance.
!
!   Copyright 2018, EUMETSAT, All Rights Reserved.
!
!-------------------------------------------------------------------------------

module radsim_mod_constants

implicit none

!-------------------------------------------------------------------------------
! General constants
!-------------------------------------------------------------------------------

! Kind values
integer, parameter :: int16  = selected_int_kind(4)        ! 2-byte integer
integer, parameter :: int32  = selected_int_kind(9)        ! 4-byte integer
integer, parameter :: int64  = selected_int_kind(15)       ! 8-byte integer
integer, parameter :: real32 = selected_real_kind(6,37)    ! 4-byte real
integer, parameter :: real64 = selected_real_kind(15,307)  ! 8-byte real

! QC error flags - used to indicate simulations that are invalid in some way.
integer, parameter :: qcflag_domain          = 0
integer, parameter :: qcflag_rttov           = 1
integer, parameter :: qcflag_emiss           = 2
integer, parameter :: qcflag_time_range      = 3
integer, parameter :: qcflag_brdf            = 4
integer, parameter :: qcflag_mfasis_geometry = 5
integer, parameter :: qcflag_mfasis_opdpedia = 6
integer, parameter :: qcflag_sat_zen_angle   = 7

character(len=18), parameter :: qcflag_text(0:7) = &
  (/ 'outside domain    ', 'rttov error       ', 'invalid emissivity', &
     'outside time range', 'invalid BRDF      ', 'MFASIS geometry   ', &
     'MFASIS opdp/edia  ', 'sat zenith angle  ' /)

! QC info flags - used to indicate simulations that should be treated with
! caution.
integer, parameter :: qcinfo_coast = 0
integer, parameter :: qcinfo_empty_footprint = 1
character(len=15), parameter :: qcinfo_text(0:1) = &
  (/ 'coastal point  ', 'empty_footprint' /)

! Error codes
integer, parameter :: status_warning = 1
integer, parameter :: status_error = 2

! Output modes
integer, parameter :: output_default = 1
integer, parameter :: output_verbose = 2
integer, parameter :: output_debug = 3

!-------------------------------------------------------------------------------
! Physical constants
!-------------------------------------------------------------------------------

!------------
! General
!------------

real(real64), parameter :: pi = 3.1415926536_real64
real(real64), parameter :: deg2rad = pi/180.0_real64
real(real64), parameter :: rad2deg = 180.0_real64/pi
real(real64), parameter :: gravity = 9.80665_real64
real(real64), parameter :: r_earth = 6371.0_real64  ! Mean Earth radius (see rttov_const.F90)
real(real64), parameter :: realtol = 1.e-10_real64

!----------------
! Ideal gases
!----------------

! R       = Universal gas constant
! m_air   = Molar mass dry air
! m_h2o   = Molar mass water
! M       = Molar mass of dry air
! R_air   = Specific gas constant for dry air
! cp      = Specific heat of dry air at constant pressure
! kappa   = R/cp (used to convert temperature to potential temperature)
! Lw      = Latent heat of vapourisation of water at 0C
! Li      = Latent heat of fusion of water at 0C
! epsilon = Rd/Rv (ratio of specific gas constants for dry air, water vapour)
! p0      = Reference pressure for theta conversion

real(real64), parameter :: R = 8.314462618_real64   ! J/mol/K
real(real64), parameter :: m_air = 28.9644_real64   ! g/mol
real(real64), parameter :: m_h2o = 18.01528_real64  ! g/mol
real(real64), parameter :: M = 0.001_real64*m_air   ! kg/mol
real(real64), parameter :: R_air = R/M              ! J/kg/K
real(real64), parameter :: cp = 1005.0_real64       ! J/kg/K
real(real64), parameter :: kappa = (R_air)/cp       !
real(real64), parameter :: Lw = 2500.0_real64       ! J/g
real(real64), parameter :: Li = 334.0_real64        ! J/g
real(real64), parameter :: epsilon = m_h2o/m_air    !
real(real64), parameter :: p0 = 100000.0_real64     ! Pa

!-------------------------------------------------------------------------------
! International standard atmosphere
!-------------------------------------------------------------------------------

! Can be used for approximate p-z conversion in the absence of better data.

! Layers:
! 0 = troposphere
! 1 = tropopause
! 2 = stratosphere
! 3 = stratosphere
! 4 = stratopause
! 5 = mesosphere
! 6 = mesosphere
! 7 = mesospause

real, target :: std_atmos_H(0:7) = 1000.0 * &
  (/ 0.0, 11.019, 20.063, 32.162, 47.350, 51.413, 71.802, 86.000 /)
real, target :: std_atmos_p(0:7) = &
  (/ 101325.0, 22632.0, 5474.9, 868.02, 110.91, 66.939, 3.9564, 0.3734 /)
real, target :: std_atmos_L(0:7) = 0.001 * &
  (/ -6.5, 0.0, 1.0, 2.8, 0.0, -2.8, -2.0, 0.0 /)
real, target :: std_atmos_T(0:7) = 273.15 + &
  (/ 15.0, -56.5, -56.5, -44.5, -2.5, -2.5, -58.5, -86.2 /)

!-------------------------------------------------------------------------------
! Parameters specific to NWP models
!-------------------------------------------------------------------------------

! Minimum cloud liquid/ice effective diameters applied to ICON fields (microns)
real(real64), parameter :: icon_clip_water = 5
real(real64), parameter :: icon_clip_ice   = 10

!-------------------------------------------------------------------------------
! ECMWF pressure level coefficients
!-------------------------------------------------------------------------------

! Reproduced from http://old.ecmwf.int/products/data/technical/model_levels/index.html

! Used to construct pressure profiles. Only 60, 91 and 137 level sets supported
! here. They are not specified as parameters because they are used as pointer
! targets in the pressure level calculation routine.

!----------
! 60 levels
!----------

real(real64), target :: plevels_ECMWF_60_A(61) = (/ &
    0.000000,    20.000000,    38.425343,    63.647804,    95.636963, &
  134.483307,   180.584351,   234.779053,   298.495789,   373.971924, &
  464.618134,   575.651001,   713.218079,   883.660522,  1094.834717, &
 1356.474609,  1680.640259,  2082.273926,  2579.888672,  3196.421631, &
 3960.291504,  4906.708496,  6018.019531,  7306.631348,  8765.053711, &
10376.126953, 12077.446289, 13775.325195, 15379.805664, 16819.474609, &
18045.183594, 19027.695313, 19755.109375, 20222.205078, 20429.863281, &
20384.480469, 20097.402344, 19584.330078, 18864.750000, 17961.357422, &
16899.468750, 15706.447266, 14411.124023, 13043.218750, 11632.758789, &
10209.500977,  8802.356445,  7438.803223,  6144.314941,  4941.778320, &
 3850.913330,  2887.696533,  2063.779785,  1385.912598,   855.361755, &
  467.333588,   210.393890,    65.889244,     7.367743,     0.000000, &
    0.000000 &
/)

real(real64), target :: plevels_ECMWF_60_B(61) = (/ &
  0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, &
  0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, &
  0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, &
  0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, &
  0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00007582, &
  0.00046139, 0.00181516, 0.00508112, 0.01114291, 0.02067788, &
  0.03412116, 0.05169041, 0.07353383, 0.09967469, 0.13002251, &
  0.16438432, 0.20247594, 0.24393314, 0.28832296, 0.33515489, &
  0.38389215, 0.43396294, 0.48477158, 0.53570992, 0.58616841, &
  0.63554746, 0.68326861, 0.72878581, 0.77159661, 0.81125343, &
  0.84737492, 0.87965691, 0.90788388, 0.93194032, 0.95182151, &
  0.96764523, 0.97966272, 0.98827010, 0.99401945, 0.99763012, &
  1.00000000 /)

!----------
! 91 levels
!----------

real(real64), target :: plevels_ECMWF_91_A(92) = (/ &
      0.000000,     2.000040,     3.980832,     7.387186,    12.908319, &
     21.413612,    33.952858,    51.746601,    76.167656,   108.715561, &
    150.986023,   204.637451,   271.356506,   352.824493,   450.685791, &
    566.519226,   701.813354,   857.945801,  1036.166504,  1237.585449, &
   1463.163940,  1713.709595,  1989.874390,  2292.155518,  2620.898438, &
   2976.302246,  3358.425781,  3767.196045,  4202.416504,  4663.776367, &
   5150.859863,  5663.156250,  6199.839355,  6759.727051,  7341.469727, &
   7942.926270,  8564.624023,  9208.305664,  9873.560547, 10558.881836, &
  11262.484375, 11982.662109, 12713.897461, 13453.225586, 14192.009766, &
  14922.685547, 15638.053711, 16329.560547, 16990.623047, 17613.281250, &
  18191.029297, 18716.968750, 19184.544922, 19587.513672, 19919.796875, &
  20175.394531, 20348.916016, 20434.158203, 20426.218750, 20319.011719, &
  20107.031250, 19785.357422, 19348.775391, 18798.822266, 18141.296875, &
  17385.595703, 16544.585938, 15633.566406, 14665.645508, 13653.219727, &
  12608.383789, 11543.166992, 10471.310547,  9405.222656,  8356.252930, &
   7335.164551,  6353.920898,  5422.802734,  4550.215820,  3743.464355, &
   3010.146973,  2356.202637,  1784.854614,  1297.656128,   895.193542, &
    576.314148,   336.772369,   162.043427,    54.208336,     6.575628, &
      0.003160,     0.000000 /)

real(real64), target :: plevels_ECMWF_91_B(92) = (/ &
  0.000000, 0.000000, 0.000000, 0.000000, 0.000000, &
  0.000000, 0.000000, 0.000000, 0.000000, 0.000000, &
  0.000000, 0.000000, 0.000000, 0.000000, 0.000000, &
  0.000000, 0.000000, 0.000000, 0.000000, 0.000000, &
  0.000000, 0.000000, 0.000000, 0.000000, 0.000000, &
  0.000000, 0.000000, 0.000000, 0.000000, 0.000000, &
  0.000000, 0.000000, 0.000000, 0.000000, 0.000000, &
  0.000014, 0.000055, 0.000131, 0.000279, 0.000548, &
  0.001000, 0.001701, 0.002765, 0.004267, 0.006322, &
  0.009035, 0.012508, 0.016860, 0.022189, 0.028610, &
  0.036227, 0.045146, 0.055474, 0.067316, 0.080777, &
  0.095964, 0.112979, 0.131935, 0.152934, 0.176091, &
  0.201520, 0.229315, 0.259554, 0.291993, 0.326329, &
  0.362203, 0.399205, 0.436906, 0.475016, 0.513280, &
  0.551458, 0.589317, 0.626559, 0.662934, 0.698224, &
  0.732224, 0.764679, 0.795385, 0.824185, 0.850950, &
  0.875518, 0.897767, 0.917651, 0.935157, 0.950274, &
  0.963007, 0.973466, 0.982238, 0.989153, 0.994204, &
  0.997630, 1.000000 /)

!-----------
! 137 levels
!-----------

real(real64), target :: plevels_ECMWF_137_A(138) = (/ &
  0.000000, 2.000365, 3.102241, 4.666084, 6.827977, 9.746966, &
  13.605424, 18.608931, 24.985718, 32.985710, 42.879242, 54.955463, &
  69.520576, 86.895882, 107.415741, 131.425507, 159.279404, 191.338562, &
  227.968948, 269.539581, 316.420746, 368.982361, 427.592499, 492.616028, &
  564.413452, 643.339905, 729.744141, 823.967834, 926.344910, 1037.201172, &
  1156.853638, 1285.610352, 1423.770142, 1571.622925, 1729.448975, 1897.519287, &
  2076.095947, 2265.431641, 2465.770508, 2677.348145, 2900.391357, 3135.119385, &
  3381.743652, 3640.468262, 3911.490479, 4194.930664, 4490.817383, 4799.149414, &
  5119.895020, 5452.990723, 5798.344727, 6156.074219, 6526.946777, 6911.870605, &
  7311.869141, 7727.412109, 8159.354004, 8608.525391, 9076.400391, 9562.682617, &
  10065.978516, 10584.631836, 11116.662109, 11660.067383, 12211.547852, 12766.873047, &
  13324.668945, 13881.331055, 14432.139648, 14975.615234, 15508.256836, 16026.115234, &
  16527.322266, 17008.789062, 17467.613281, 17901.621094, 18308.433594, 18685.718750, &
  19031.289062, 19343.511719, 19620.042969, 19859.390625, 20059.931641, 20219.664062, &
  20337.863281, 20412.308594, 20442.078125, 20425.718750, 20361.816406, 20249.511719, &
  20087.085938, 19874.025391, 19608.572266, 19290.226562, 18917.460938, 18489.707031, &
  18006.925781, 17471.839844, 16888.687500, 16262.046875, 15596.695312, 14898.453125, &
  14173.324219, 13427.769531, 12668.257812, 11901.339844, 11133.304688, 10370.175781, &
  9617.515625, 8880.453125, 8163.375000, 7470.343750, 6804.421875, 6168.531250, &
  5564.382812, 4993.796875, 4457.375000, 3955.960938, 3489.234375, 3057.265625, &
  2659.140625, 2294.242188, 1961.500000, 1659.476562, 1387.546875, 1143.250000, &
  926.507812, 734.992188, 568.062500, 424.414062, 302.476562, 202.484375, &
  122.101562, 62.781250, 22.835938, 3.757813, 0.000000, 0.000000 /)

real(real64), target :: plevels_ECMWF_137_B(138) = (/ &
  0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, &
  0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, &
  0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, &
  0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, &
  0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, &
  0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, &
  0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, &
  0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, &
  0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, &
  0.000000, 0.000007, 0.000024, 0.000059, 0.000112, 0.000199, &
  0.000340, 0.000562, 0.000890, 0.001353, 0.001992, 0.002857, &
  0.003971, 0.005378, 0.007133, 0.009261, 0.011806, 0.014816, &
  0.018318, 0.022355, 0.026964, 0.032176, 0.038026, 0.044548, &
  0.051773, 0.059728, 0.068448, 0.077958, 0.088286, 0.099462, &
  0.111505, 0.124448, 0.138313, 0.153125, 0.168910, 0.185689, &
  0.203491, 0.222333, 0.242244, 0.263242, 0.285354, 0.308598, &
  0.332939, 0.358254, 0.384363, 0.411125, 0.438391, 0.466003, &
  0.493800, 0.521619, 0.549301, 0.576692, 0.603648, 0.630036, &
  0.655736, 0.680643, 0.704669, 0.727739, 0.749797, 0.770798, &
  0.790717, 0.809536, 0.827256, 0.843881, 0.859432, 0.873929, &
  0.887408, 0.899900, 0.911448, 0.922096, 0.931881, 0.940860, &
  0.949064, 0.956550, 0.963352, 0.969513, 0.975078, 0.980072, &
  0.984542, 0.988500, 0.991984, 0.995003, 0.997630, 1.000000 /)

!-------------------------------------------------------------------------------
! HARMONIE pressure level coefficients
!-------------------------------------------------------------------------------

! Provided by Jan Fokke Meirink and Sander Tijm (KNMI)

! Used to construct pressure profiles. Only the 65 level set supported here.
! They are not specified as parameters because they are used as pointer
! targets in the pressure level calculation routine.

!----------
! 65 levels
!----------

real(real64), target :: plevels_HARMONIE_65_A(66) = (/ &
  0.000000000000000E+000,   2000.00000000000,        4000.21289062500,      &
   6002.09765625000,        7911.25781250000,        9633.01171875000,      &
   11169.3710937500,        12522.5781250000,        13695.0000000000,      &
   14689.1171875000,        15507.4921875000,        16154.6953125000,      &
   16632.1250000000,        16940.1484375000,        17082.3476562500,      &
   17065.2812500000,        16898.1835937500,        16592.5898437500,      &
   16161.9023437500,        15620.9453125000,        14985.4648437500,      &
   14271.7070312500,        13495.9609375000,        12674.1679687500,      &
   11821.6015625000,        10952.5703125000,        10080.1992187500,      &
   9216.28515625000,        8371.17968750000,        7553.74609375000,      &
   6771.35546875000,        6029.92187500000,        5333.95703125000,      &
   4686.67968750000,        4090.09521484375,        3545.12646484375,      &
   3051.73803710938,        2609.05810546875,        2215.50463867188,      &
   1868.90771484375,        1566.62817382812,        1305.66870117188,      &
   1081.85498046875,        890.476074218750,        727.745605468750,      &
   590.177490234375,        474.587646484375,        378.088623046875,      &
   298.079589843750,        232.233123779297,        178.480148315430,      &
   134.992080688477,        100.163696289062,        72.5952911376953,      &
   51.0750885009766,        34.5621643066406,        22.1702270507812,      &
   13.1522598266602,        6.88641357421875,        2.86306095123291,      &
  0.673443555831909,       0.000000000000000E+000,  0.000000000000000E+000, &
  0.000000000000000E+000,  0.000000000000000E+000,  0.000000000000000E+000 /)

real(real64), target :: plevels_HARMONIE_65_B(66) = (/ &
  0.000000000000000E+000,  0.000000000000000E+000,  0.000000000000000E+000, &
  0.000000000000000E+000,  9.546799119561911E-004,  3.825699910521507E-003, &
  8.623268455266953E-003,  1.535781845450401E-002,  2.404046058654785E-002, &
  3.468314185738564E-002,  4.729839041829109E-002,  6.195101886987686E-002, &
  7.868188619613647E-002,  9.744322299957275E-002,  0.118155837059021,      &
  0.140711009502411,       0.164973497390747,       0.190785527229309,      &
  0.217970848083496,       0.246339261531830,       0.275691211223602,      &
  0.305822432041168,       0.336528241634369,       0.367607235908508,      &
  0.398864805698395,       0.430115640163422,       0.461186230182648,      &
  0.491916239261627,       0.522159457206726,       0.551784455776215,      &
  0.580674409866333,       0.608727097511292,       0.635853886604309,      &
  0.661979138851166,       0.687038958072662,       0.710980355739594,      &
  0.733759641647339,       0.755341410636902,       0.775697350502014,      &
  0.794804871082306,       0.812645971775055,       0.829206347465515,      &
  0.844539999961853,       0.858755052089691,       0.871918022632599,      &
  0.884092748165131,       0.895340442657471,       0.905719637870789,      &
  0.915286421775818,       0.924094498157501,       0.932195484638214,      &
  0.939638972282410,       0.946472764015198,       0.952743291854858,      &
  0.958495497703552,       0.963773429393768,       0.968620061874390,      &
  0.973078012466431,       0.977189421653748,       0.980996370315552,      &
  0.984541296958923,       0.987867295742035,       0.991024613380432,      &
  0.994065105915070,       0.997039258480072,        1.00000000000000 /)

!-------------------------------------------------------------------------------
! JMA pressure level coefficients
!-------------------------------------------------------------------------------

! Reproduced from
! 60L:
! https://jra.kishou.go.jp/JRA-55/document/JRA-55_handbook_TL319_en.pdf
! 100L:
! https://confluence.ecmwf.int/display/S2S/JMA+Model+Description+GEPS1701?
!   preview=/78282943/78284296/GEPS_model_description_appendix.pdf

! Used to construct pressure profiles.
! Only 60 and 100 level sets supported here.

!----------
! 60 levels
!----------

real(real64), target :: plevels_JMA_60_A(61) = (/ 0.000000000000, &
          0.000000000000,     0.000000000000,     0.000000000000, &
          0.000000000000,     0.000000000000,     0.000000000000, &
          0.000000000000,     0.000000000000,   133.051011276943, &
        364.904148871589,   634.602716447362,   959.797167291774, &
       1347.680041655150,  1790.907395951100,  2294.841689948500, &
       2847.484777711760,  3468.871488118640,  4162.956462969160, &
       4891.880832504910,  5671.824239804080,  6476.712996385320, &
       7297.469894720490,  8122.159791249150,  8914.082201062340, &
       9656.181910501640, 10329.436177774600, 10912.638444238700, &
      11369.647830843200, 11695.371597470000, 11861.253087394800, &
      11855.434316349300, 11663.355365580300, 11285.404064494200, &
      10729.949405567900, 10014.615053510700,  9167.247035833100, &
       8226.244907704420,  7201.568980298280,  6088.673008533920, &
       4950.000000000000,  4000.000000000000,  3230.000000000000, &
       2610.000000000000,  2105.000000000000,  1700.000000000000, &
       1370.000000000000,  1105.000000000000,   893.000000000000, &
        720.000000000000,   581.000000000000,   469.000000000000, &
        377.000000000000,   301.000000000000,   237.000000000000, &
        182.000000000000,   136.000000000000,    97.000000000000, &
         65.000000000000,    39.000000000000,    20.000000000000 /)

real(real64), target :: plevels_JMA_60_B(61) = &
(/ 1.000000000000000000, 0.997000000000000000, 0.994000000000000000, &
   0.989000000000000000, 0.982000000000000000, 0.972000000000000000, &
   0.960000000000000000, 0.946000000000000000, 0.926669489887231000, &
   0.904350958511284000, 0.879653972835526000, 0.851402028327082000, &
   0.819523199583449000, 0.785090926040489000, 0.748051583100515000, &
   0.709525152222882000, 0.668311285118814000, 0.624370435370308000, &
   0.580081191674951000, 0.534281757601959000, 0.488232870036147000, &
   0.442025301052795000, 0.395778402087509000, 0.350859177989377000, &
   0.307438180894984000, 0.265705638222254000, 0.225873615557613000, &
   0.189303521691568000, 0.155046284025300000, 0.124387469126052000, &
   0.096445656836507500, 0.072366446344196600, 0.052145959355057800, &
   0.035700505944321400, 0.022853849464893500, 0.013327529641668900, &
   0.006737550922955820, 0.002484310197017220, 0.000113269914660783, &
   0.000000000000000000, 0.000000000000000000, 0.000000000000000000, &
   0.000000000000000000, 0.000000000000000000, 0.000000000000000000, &
   0.000000000000000000, 0.000000000000000000, 0.000000000000000000, &
   0.000000000000000000, 0.000000000000000000, 0.000000000000000000, &
   0.000000000000000000, 0.000000000000000000, 0.000000000000000000, &
   0.000000000000000000, 0.000000000000000000, 0.000000000000000000, &
   0.000000000000000000, 0.000000000000000000, 0.000000000000000000, &
   0.000000000000000000 /)

!-----------
! 100 levels
!-----------

real(real64), target :: plevels_JMA_100_A(101) = (/0.000000000000, &
           0.381960371274,     2.282912116885,     7.263035741060, &
          17.501423784709,    35.837818528753,    65.788588562684, &
         111.534494496255,   177.878560017639,   270.173200177349, &
         394.216660935207,   556.119785479916,   762.145131558889, &
        1018.521502093580,  1331.237994182840,  1705.822687785370, &
        2147.112046884750,  2659.017949071050,  3244.299946519710, &
        3904.350843037290,  4639.003900351110,  5446.369919361920, &
        6322.712044687760,  7262.365392218190,  8257.707494428910, &
        9299.184110690550, 10375.393194275100, 11473.227799960100, &
       12578.076531849900, 13674.077863475800, 14744.422417575000, &
       15771.695184622600, 16738.247801019900, 17626.589506536500, &
       18419.784348312200, 19101.841666029400, 19658.086923129000, &
       20075.528020764800, 20348.204534314600, 20482.864577903400, &
       20488.764993118100, 20375.968557002400, 20155.123908885900, &
       19837.250236607800, 19433.531725236600, 18955.126107165600, &
       18412.990881865800, 17817.729937538000, 17179.462446459200, &
       16507.715059741200, 15811.337630045400, 15098.441971265300, &
       14376.362544194500, 13651.637451362600, 12930.007739834300, &
       12216.432748330100, 11515.119089025100, 10829.560814360000, &
       10162.588370980400,  9516.424069790310,  8892.741985017770, &
        8292.730417742580,  7717.155302649380,  7166.423184127830, &
        6640.642624128240,  6139.683116216300,  5664.273333449310, &
        5216.156035873420,  4793.669512829290,  4395.113401275500, &
        4018.949179441300,  3663.806945739750,  3328.490442759910, &
        3011.979920608280,  2713.432303648210,  2432.178008474700, &
        2167.713677654230,  1919.690067136030,  1687.894382929320, &
        1472.226533650630,  1272.669075953680,  1089.251096446150, &
         922.006895759386,   770.931090588804,   635.932565397326, &
         516.790485034353,   413.116183588936,   324.325010406765, &
         249.621981177447,   188.004232058539,   138.281777767921, &
          99.116030468172,    69.073197343268,    46.687430698176, &
          30.526919677562,    19.255419160479,    11.682278394236, &
           6.795854571503,     3.777949571397,     2.000000000000, &
           1.000000000000 /)

real(real64), target :: plevels_JMA_100_B(101) = (/ 1.000000000000, &
   0.998082302320, 0.995295152540, 0.991568910490, &
   0.986835726509, 0.981028998386, 0.974083102672, &
   0.965933418157, 0.956516652201, 0.945771472535, &
   0.933639438313, 0.920066214680, 0.905003045132, &
   0.888408445709, 0.870250074835, 0.850506722823, &
   0.829170356011, 0.806248142726, 0.781764382176, &
   0.755762253571, 0.728305301549, 0.699478575927, &
   0.669389349082, 0.638167343135, 0.605964411538, &
   0.572953635479, 0.539327814317, 0.505297350453, &
   0.471087551766, 0.436935398115, 0.403085841256, &
   0.369787728735, 0.337289460678, 0.305834502976, &
   0.275656890050, 0.246976854698, 0.219996720901, &
   0.194896913328, 0.171782212581, 0.150624810943, &
   0.131366211745, 0.113934233832, 0.098245261029, &
   0.084206511655, 0.071718272305, 0.060676045775, &
   0.050972569937, 0.042499672253, 0.035149932979, &
   0.028818138556, 0.023402514934, 0.018805738142, &
   0.014935726284, 0.011706222916, 0.009037186420, &
   0.006855003584, 0.005092547928, 0.003689104692, &
   0.002590184771, 0.001747249438, 0.001117366638, &
   0.000662818044, 0.000350674188, 0.000152352890, &
   0.000043174116, 0.000001922353, 0.000000000000, &
   0.000000000000, 0.000000000000, 0.000000000000, &
   0.000000000000, 0.000000000000, 0.000000000000, &
   0.000000000000, 0.000000000000, 0.000000000000, &
   0.000000000000, 0.000000000000, 0.000000000000, &
   0.000000000000, 0.000000000000, 0.000000000000, &
   0.000000000000, 0.000000000000, 0.000000000000, &
   0.000000000000, 0.000000000000, 0.000000000000, &
   0.000000000000, 0.000000000000, 0.000000000000, &
   0.000000000000, 0.000000000000, 0.000000000000, &
   0.000000000000, 0.000000000000, 0.000000000000, &
   0.000000000000, 0.000000000000, 0.000000000000, &
   0.000000000000 /) 

!------------------------------------------------------------------------
! Data from RTTOV v13 rttov_const module for rain/snow flux conversion
!------------------------------------------------------------------------

! The flux conversion in RTTOV is deprecated and will be removed in the
! future so the calculation is done in RadSim following the same approach

real(real64), parameter :: rho_rain = 1.0_real64 ! Rain density (g.cm-3)
real(real64), parameter :: rho_snow = 0.1_real64 ! snow density (g.cm-3)
! Flux to density conversions using RR = a * LWC^b, [RR]=mm/h, [LWC]=g/m^3
! See Geer et al. (2007) ECMWF Tech. Memo. 535, appendix B, for more info
! The variables store 1/a and 1/b for rain and snow and converted to kg/m2/s from mm/h:
real(real64), parameter :: conv_rain(2) = (/ 3600.0_real64/20.89_real64, 1._real64/1.15_real64 /)
real(real64), parameter :: conv_snow(2) = (/ 3600.0_real64/29.51_real64, 1._real64/1.10_real64 /)

end module radsim_mod_constants
