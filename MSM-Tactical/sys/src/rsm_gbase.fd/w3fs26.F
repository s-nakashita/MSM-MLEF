       SUBROUTINE W3FS26(JLDAYN,IYEAR,MONTH,IDAY,IDAYWK,IDAYYR)
!$$$   SUBPROGRAM  DOCUMENTATION  BLOCK
!
! SUBPROGRAM: W3FS26         YEAR, MONTH, DAY FROM JULIAN DAY NUMBER
!   AUTHOR: JONES,R.E.       ORG: W342       DATE: 87-03-29
!
! ABSTRACT: COMPUTES YEAR (4 DIGITS), MONTH, DAY, DAY OF WEEK, DAY
!   OF YEAR FROM JULIAN DAY NUMBER. THIS SUBROUTINE WILL WORK
!   FROM 1583 A.D. TO 3300 A.D.
!
! PROGRAM HISTORY LOG:
!   87-03-29  R.E.JONES
!   89-10-25  R.E.JONES   CONVERT TO CRAY CFT77 FORTRAN
!
! USAGE:  CALL W3FS26(JLDAYN,IYEAR,MONTH,IDAY,IDAYWK,IDAYYR)
!
!   INPUT VARIABLES:
!     NAMES  INTERFACE DESCRIPTION OF VARIABLES AND TYPES
!     ------ --------- -----------------------------------------------
!     JLDAYN ARG LIST  INTEGER   JULIAN DAY NUMBER
!
!   OUTPUT VARIABLES:
!     NAMES  INTERFACE DESCRIPTION OF VARIABLES AND TYPES
!     ------ --------- -----------------------------------------------
!     IYEAR  ARG LIST  INTEGER   YEAR  (4 DIGITS)
!     MONTH  ARG LIST  INTEGER   MONTH
!     IDAY   ARG LIST  INTEGER   DAY
!     IDAYWK ARG LIST  INTEGER   DAY OF WEEK (1 IS SUNDAY, 7 IS SAT)
!     IDAYYR ARG LIST  INTEGER   DAY OF YEAR (1 TO 366)
!
!   REMARKS: A JULIAN DAY NUMBER CAN BE COMPUTED BY USING ONE OF THE
!     FOLLOWING STATEMENT FUNCTIONS. A DAY OF WEEK CAN BE COMPUTED
!     FROM THE JULIAN DAY NUMBER. A DAY OF YEAR CAN BE COMPUTED FROM
!     A JULIAN DAY NUMBER AND YEAR.
!
!      IYEAR (4 DIGITS)
!
!      JDN(IYEAR,MONTH,IDAY) = IDAY - 32075
!    &            + 1461 * (IYEAR + 4800 + (MONTH - 14) / 12) / 4
!    &            + 367 * (MONTH - 2 - (MONTH -14) / 12 * 12) / 12
!    &            - 3 * ((IYEAR + 4900 + (MONTH - 14) / 12) / 100) / 4
!
!      IYR (4 DIGITS) , IDYR(1-366) DAY OF YEAR
!
!      JULIAN(IYR,IDYR) = -31739 + 1461 * (IYR + 4799) / 4
!    &                    -3 * ((IYR + 4899) / 100) / 4 + IDYR
!
!      DAY OF WEEK FROM JULIAN DAY NUMBER, 1 IS SUNDAY, 7 IS SATURDAY.
!
!      JDAYWK(JLDAYN) = MOD((JLDAYN + 1),7) + 1
!
!      DAY OF YEAR FROM JULIAN DAY NUMBER AND 4 DIGIT YEAR.
!
!      JDAYYR(JLDAYN,IYEAR) = JLDAYN -
!     &  (-31739+1461*(IYEAR+4799)/4-3*((IYEAR+4899)/100)/4)
!
!      THE FIRST FUNCTION WAS IN A LETTER TO THE EDITOR COMMUNICATIONS
!      OF THE ACM  VOLUME 11 / NUMBER 10 / OCTOBER, 1968. THE 2ND
!      FUNCTION WAS DERIVED FROM THE FIRST. THIS SUBROUTINE WAS ALSO
!      INCLUDED IN THE SAME LETTER. JULIAN DAY NUMBER 1 IS
!      JAN 1,4713 B.C. A JULIAN DAY NUMBER CAN BE USED TO REPLACE A
!      DAY OF CENTURY, THIS WILL TAKE CARE OF THE DATE PROBLEM IN
!      THE YEAR 2000, OR REDUCE PROGRAM CHANGES TO ONE LINE CHANGE
!      OF 1900 TO 2000. JULIAN DAY NUMBERS CAN BE USED FOR FINDING
!      RECORD NUMBERS IN AN ARCHIVE OR DAY OF WEEK, OR DAY OF YEAR.
!
! ATTRIBUTES:
!   LANGUAGE: CRAY CFT77 FORTRAN
!   MACHINE:  CRAY Y-MP8/864
!
!$$$
!
       L      = JLDAYN + 68569
       N      = 4 * L / 146097
       L      = L - (146097 * N + 3) / 4
       I      = 4000 * (L + 1) / 1461001
       L      = L - 1461 * I / 4 + 31
       J      = 80 * L / 2447
       IDAY   = L - 2447 * J / 80
       L      = J / 11
       MONTH  = J + 2 - 12 * L
       IYEAR  = 100 * (N - 49) + I + L
       IDAYWK = MOD((JLDAYN + 1),7) + 1
       IDAYYR = JLDAYN -                                                &
     &  (-31739 +1461 * (IYEAR+4799) / 4 - 3 * ((IYEAR+4899)/100)/4)
       RETURN
       END
